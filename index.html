<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMF + ORI ‚Äî IELTS Writing Task 2 Pro</title>
    <meta name="description" content="Luy·ªán vi·∫øt IELTS Writing Task 2 Academic v·ªõi AI ch·∫•m b√†i chu·∫©n rubric IDP">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- ========== LOGIN SCREEN ========== -->
    <div class="login-screen" id="loginScreen">
        <div class="login-card">
            <div class="login-brand">
                <span class="login-icon">‚úçÔ∏è</span>
                <h1>SMF + ORI</h1>
                <p>IELTS Writing Task 2 Pro</p>
            </div>
            <div class="login-form">
                <label for="loginPassword">üîí Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p</label>
                <input type="password" id="loginPassword" placeholder="M·∫≠t kh·∫©u..."
                    onkeydown="if(event.key==='Enter')doLogin()">
                <button class="btn btn-primary btn-login" onclick="doLogin()">üöÄ ƒêƒÉng nh·∫≠p</button>
                <p class="login-error" id="loginError"></p>
            </div>
            <div class="login-footer">
                Made by Mrs Kate Tr·∫ßn ‚Äî SMF English Center ‚Äî Hotline 0906 303 373
            </div>
        </div>
    </div>

    <!-- ========== APP (hidden until login) ========== -->
    <div class="app-wrapper" id="appWrapper" style="display:none;">

        <!-- ========== HEADER ========== -->
        <header class="header">
            <div class="header-inner">
                <div class="brand">
                    <span class="brand-icon">‚úçÔ∏è</span>
                    <div>
                        <h1>SMF + ORI <span class="brand-highlight">IELTS Writing Task 2 Pro</span></h1>
                        <p class="brand-sub">AI-Powered Essay Grading ‚Äî Chu·∫©n Rubric IDP</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-settings" onclick="openSettings()" title="C√†i ƒë·∫∑t API Key">‚öôÔ∏è</button>
                </div>
            </div>
        </header>

        <!-- ========== NAVIGATION ========== -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="write" onclick="switchTab('write')">üìù Vi·∫øt b√†i</button>
            <button class="nav-tab" data-tab="questions" onclick="switchTab('questions')">üìñ Ng√¢n h√†ng ƒë·ªÅ</button>
            <button class="nav-tab" data-tab="types" onclick="switchTab('types')">üìö D·∫°ng b√†i</button>
            <button class="nav-tab" data-tab="grammar" onclick="switchTab('grammar')">üí° Grammar</button>
            <button class="nav-tab" data-tab="samples" onclick="switchTab('samples')">üèÜ M·∫´u ƒë√°p √°n</button>
            <button class="nav-tab" data-tab="history" onclick="switchTab('history')">üìã L·ªãch s·ª≠</button>
        </nav>

        <!-- ========== MAIN CONTENT ========== -->
        <main class="main-content">

            <!-- TAB 1: WRITE -->
            <section id="tab-write" class="tab-content active">
                <div class="write-container">
                    <!-- Left: Essay Input -->
                    <div class="write-panel">
                        <div class="panel-header">
                            <h2>üìù Vi·∫øt b√†i IELTS Task 2</h2>
                            <div class="timer-display">
                                <button class="btn btn-sm btn-timer" onclick="toggleTimer()" id="timerBtn">‚è±Ô∏è B·∫Øt ƒë·∫ßu
                                    40:00</button>
                                <span id="timerDisplay" class="timer-text"></span>
                            </div>
                        </div>

                        <!-- Essay Type Selector -->
                        <div class="form-group">
                            <label>D·∫°ng b√†i</label>
                            <select id="essayTypeSelect" onchange="updateEssayType()">
                                <option value="">‚Äî Ch·ªçn d·∫°ng b√†i ‚Äî</option>
                                <option value="opinion">üí¨ Opinion (Agree/Disagree)</option>
                                <option value="discussion">‚öñÔ∏è Discussion (Both Views)</option>
                                <option value="advantages">üìä Advantages & Disadvantages</option>
                                <option value="problem">üîß Problem & Solution</option>
                                <option value="twopart">‚ùì Two-Part Question</option>
                            </select>
                        </div>

                        <!-- Topic Input -->
                        <div class="form-group">
                            <label>ƒê·ªÅ b√†i <button class="btn btn-sm btn-ideas" onclick="generateIdeas()" id="ideasBtn"
                                    title="AI g·ª£i √Ω √Ω t∆∞·ªüng">üí° G·ª£i √Ω √Ω t∆∞·ªüng</button></label>
                            <textarea id="topicInput" rows="3"
                                placeholder="Nh·∫≠p ƒë·ªÅ b√†i IELTS Writing Task 2 ·ªü ƒë√¢y..."></textarea>
                        </div>

                        <!-- Ideas Panel (hidden by default) -->
                        <div id="ideasPanel" class="ideas-panel hidden">
                            <div class="ideas-header">
                                <h3>üí° G·ª£i √Ω √Ω t∆∞·ªüng & Outline</h3>
                                <button class="btn btn-sm" onclick="closeIdeas()">‚úï</button>
                            </div>
                            <div id="ideasContent" class="ideas-content">
                                <!-- AI-generated ideas appear here -->
                            </div>
                        </div>

                        <!-- Essay Textarea -->
                        <div class="form-group">
                            <label>B√†i vi·∫øt <span class="word-count" id="wordCount">0 t·ª´</span></label>
                            <textarea id="essayInput" rows="18"
                                placeholder="Vi·∫øt b√†i essay ·ªü ƒë√¢y... (t·ªëi thi·ªÉu 250 t·ª´)"></textarea>
                        </div>

                        <div class="write-actions">
                            <button class="btn btn-primary btn-grade" onclick="gradeEssay()" id="gradeBtn">
                                üéØ Ch·∫•m b√†i AI
                            </button>
                            <button class="btn btn-sample" onclick="generateSampleEssay()" id="sampleBtn">
                                ‚úçÔ∏è T·∫°o b√†i m·∫´u AI
                            </button>
                            <button class="btn btn-secondary" onclick="clearEssay()">üóëÔ∏è X√≥a</button>
                        </div>
                    </div>

                    <!-- Right: Results -->
                    <div class="results-panel" id="resultsPanel">
                        <div class="results-placeholder">
                            <div class="placeholder-icon">üìä</div>
                            <h3>K·∫øt qu·∫£ ch·∫•m b√†i</h3>
                            <p>Vi·∫øt b√†i v√† nh·∫•n "Ch·∫•m b√†i AI" ƒë·ªÉ nh·∫≠n k·∫øt qu·∫£ chi ti·∫øt theo rubric IELTS IDP.</p>
                            <div class="rubric-preview">
                                <div class="rubric-item"><span class="rubric-label">TR</span> Task Response</div>
                                <div class="rubric-item"><span class="rubric-label">CC</span> Coherence & Cohesion</div>
                                <div class="rubric-item"><span class="rubric-label">LR</span> Lexical Resource</div>
                                <div class="rubric-item"><span class="rubric-label">GRA</span> Grammar Range & Accuracy
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB 2: QUESTION BANK -->
            <section id="tab-questions" class="tab-content">
                <div class="questions-container">
                    <h2>üìñ Ng√¢n h√†ng ƒë·ªÅ Cambridge IELTS</h2>
                    <p class="subtitle">T·ªïng h·ª£p ƒë·ªÅ Writing Task 2 t·ª´ Cambridge IELTS 11‚Äì18. Nh·∫•n "D√πng ƒë·ªÅ n√†y" ƒë·ªÉ
                        chuy·ªÉn sang tab vi·∫øt b√†i.</p>

                    <!-- Filter -->
                    <div class="qbank-filters">
                        <button class="qbank-filter active" onclick="filterQuestions('all', this)">T·∫•t c·∫£</button>
                        <button class="qbank-filter" onclick="filterQuestions('opinion', this)">üí¨ Opinion</button>
                        <button class="qbank-filter" onclick="filterQuestions('discussion', this)">‚öñÔ∏è
                            Discussion</button>
                        <button class="qbank-filter" onclick="filterQuestions('advantages', this)">üìä
                            Adv/Disadv</button>
                        <button class="qbank-filter" onclick="filterQuestions('problem', this)">üîß Problem</button>
                        <button class="qbank-filter" onclick="filterQuestions('twopart', this)">‚ùì Two-Part</button>
                    </div>

                    <div id="questionsGrid" class="questions-grid">
                        <!-- JS renders here -->
                    </div>
                </div>
            </section>

            <!-- TAB 3: ESSAY TYPES -->
            <section id="tab-types" class="tab-content">
                <div class="types-container">
                    <h2>üìö 5 D·∫°ng b√†i IELTS Writing Task 2</h2>
                    <p class="subtitle">Nh·∫•n v√†o t·ª´ng d·∫°ng ƒë·ªÉ xem chi ti·∫øt c·∫•u tr√∫c, m·∫πo vi·∫øt v√† ƒë·ªÅ m·∫´u.</p>
                    <div class="types-grid" id="typesGrid">
                        <!-- JS renders here -->
                    </div>
                </div>
            </section>

            <!-- TAB 4: GRAMMAR -->
            <section id="tab-grammar" class="tab-content">
                <div class="grammar-container">
                    <h2>üí° C·∫•u tr√∫c Grammar Band Cao</h2>
                    <p class="subtitle">10 c·∫•u tr√∫c ng·ªØ ph√°p n√¢ng cao gi√∫p tƒÉng ƒëi·ªÉm Grammatical Range & Accuracy.</p>
                    <div class="grammar-grid" id="grammarGrid">
                        <!-- JS renders here -->
                    </div>
                </div>
            </section>

            <!-- TAB 5: SAMPLE ANSWERS -->
            <section id="tab-samples" class="tab-content">
                <div class="samples-container">
                    <h2>üèÜ M·∫´u ƒê√°p √Ån 6.5 ‚Üí 9.0</h2>
                    <div class="sample-topic-box">
                        <h3>üìã ƒê·ªÅ b√†i:</h3>
                        <p id="sampleTopic"></p>
                    </div>
                    <div class="band-tabs" id="bandTabs">
                        <!-- JS renders here -->
                    </div>
                    <div id="sampleContent" class="sample-content">
                        <!-- JS renders here -->
                    </div>
                </div>
            </section>

            <!-- TAB 6: HISTORY -->
            <section id="tab-history" class="tab-content">
                <div class="history-container">
                    <h2>üìã L·ªãch s·ª≠ b√†i vi·∫øt</h2>
                    <p class="subtitle">Xem l·∫°i c√°c b√†i vi·∫øt v√† k·∫øt qu·∫£ ch·∫•m tr∆∞·ªõc ƒë√≥.</p>
                    <div id="historyList" class="history-list">
                        <!-- JS renders here -->
                    </div>
                </div>
            </section>
        </main>

        <!-- ========== FOOTER ========== -->
        <footer class="footer">
            <div class="footer-brand">SMF + ORI ‚Äî IELTS Writing Task 2 Pro</div>
            <div class="footer-credit">Made by Mrs Kate Tr·∫ßn ‚Äî SMF English Center ‚Äî Hotline 0906 303 373</div>
        </footer>
    </div>

    <!-- ========== SETTINGS MODAL ========== -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <h2>‚öôÔ∏è C√†i ƒë·∫∑t</h2>
            <div class="form-group">
                <label for="groqApiKey">Groq API Key</label>
                <input type="password" id="groqApiKey" placeholder="gsk_...">
                <small>ƒêƒÉng k√Ω mi·ªÖn ph√≠ t·∫°i <a href="https://console.groq.com"
                        target="_blank">console.groq.com</a></small>
            </div>
            <div class="form-group">
                <label for="modelSelect">AI Model</label>
                <select id="modelSelect">
                    <option value="llama-3.3-70b-versatile">Llama 3.3 70B (Recommended)</option>
                    <option value="llama-3.1-8b-instant">Llama 3.1 8B (Faster)</option>
                    <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSettings()">H·ªßy</button>
                <button class="btn btn-primary" onclick="saveSettings()">üíæ L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- ========== LOADING OVERLAY ========== -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h3>üéØ AI ƒëang ch·∫•m b√†i...</h3>
            <p id="loadingText">Ph√¢n t√≠ch theo 4 ti√™u ch√≠ IELTS IDP rubric</p>
        </div>
    </div>

    <!-- ========== TOAST ========== -->
    <div class="toast" id="toast"></div>

    <script src="essay-types.js"></script>
    <script src="prompts.js"></script>
    <script src="sample-answers.js"></script>
    <script src="cambridge-questions.js"></script>
    <script src="app.js"></script>
</body>

</html>